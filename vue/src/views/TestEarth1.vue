<template>
  <div id="video-particles" class="particles-container"></div>
  <!--  <div class="test-fixed">æˆ‘æ˜¯æµ‹è¯• Fixed</div>-->
<!--  <div class="page2" id="earth-background">-->
<!--    <el-button type="primary" style="position: absolute;top: 250px;left: 300px">åŸºæœ¬æŒ‰é’®</el-button>-->
<!--  </div>-->
<!--  <div class="page3">-->
<!--    <div style="position: absolute;top: 2000px;left: 100px;font-weight: bold;font-size: 30px">THIS IS MY WORLD!</div>-->
<!--  </div>-->
<!--  <div class="page4" id="star-background">-->

<!--  </div>-->

<!--  <section>-->
<!--    <div class="container section1">-->
<!--      <div class="earth" id="earth-background"></div>-->
<!--      <div class="page1" id="star-background"></div>-->
<!--      <div class="buttons" style="top: 600px;left: 350px">-->
<!--        <el-button type="primary" @click="changeSpeed">-->
<!--          <span v-if="data.rotateSpeed > 0">åœæ­¢è½¬åŠ¨</span>-->
<!--          <span v-else>ç»§ç»­è½¬åŠ¨</span>-->
<!--        </el-button>-->
<!--      </div>-->
<!--      <div class="hero-title glowing-title floating-title">-->
<!--        æ™ºç»˜å±±æ²³-->
<!--      </div>-->
<!--      <div class="line1 hero-subtitle">AI èµ‹èƒ½æ¢ç´¢</div>-->
<!--      <div class="line2 hero-subtitle">è®©åœ°ç†æ›´æ™ºæ…§</div>-->
<!--      <div class="line3 hero-subtitle">ç”¨ç§‘æŠ€ä¸ˆé‡ä¸–ç•Œ</div>-->
<!--    </div>-->
<!--  </section>-->
<!--  <section>-->

<!--    <div class="container section2">-->
<!--      &lt;!&ndash;    è¿‡æ¸¡æ–‡å­—  &ndash;&gt;-->
<!--      <div class="transition-words">-->
<!--        <span class="c1">æ¢ç´¢</span>-->
<!--        <span class="c2">ä¸–ç•Œï¼Œ</span>-->
<!--        <span class="c3">ä»</span>-->
<!--        <span class="c4">è¿™é‡Œ</span>-->
<!--        <span class="c5">å¯ç¨‹ã€‚</span>-->
<!--      </div>-->
<!--      &lt;!&ndash;    æ™ºç»˜å¤©åœ°ä»‹ç»  &ndash;&gt;-->
<!--      <div class="page2">-->
<!--        <h2 class="section-title">ğŸŒ ç›´è§‚å¯è§†åŒ–ï¼Œæ¢ç´¢åœ°ç†å¥¥ç§˜</h2>-->
<!--        <div class="step-indicator">Step 1: äº†è§£</div>-->
<!--        <p class="section-subtitle">æ²‰æµ¸å¼ 3D ä½“éªŒï¼Œè®©ä½ èº«ä¸´å…¶å¢ƒ</p>-->
<!--        <p class="section-content">é€šè¿‡ 3D äº¤äº’åœ°çƒã€æ°”å€™æ¨¡å‹ç­‰ï¼Œè®©åœ°ç†çŸ¥è¯†å˜å¾—ç”ŸåŠ¨å½¢è±¡ã€‚</p>-->
<!--      </div>-->
<!--      &lt;!&ndash;    è¿›åº¦æ¡  &ndash;&gt;-->
<!--      <el-progress-->
<!--          :percentage="data.percentage[0]"-->
<!--          :text-inside="true"-->
<!--          :stroke-width="30"-->
<!--          striped-->
<!--          striped-flow-->
<!--          :duration="5"-->
<!--          class="progress"-->
<!--      >-->
<!--        <span v-if="data.percentage[0] < 25">æ™ºç»˜å¤©åœ°</span>-->
<!--        <span v-else-if="data.percentage[0] < 50">çŸ¥è±¡å›¾è°±</span>-->
<!--        <span v-else-if="data.percentage[0] < 75">æ¢çŸ¥é—®å­¦</span>-->
<!--        <span v-else>æ™ºèå­¦å ‚</span>-->
<!--        <span>{{ parseInt(data.percentage[0]) }}%</span>-->
<!--      </el-progress>-->
<!--      &lt;!&ndash;    çŸ¥è±¡å›¾è°±ä»‹ç»  &ndash;&gt;-->
<!--      <div class="page3">-->
<!--        <h2 class="section-title">ğŸ“Š çŸ¥è¯†å›¾è°± + AI äº’åŠ¨</h2>-->
<!--        <div class="step-indicator">Step 2: å­¦ä¹ </div>-->
<!--        <p class="section-subtitle">ç»“æ„åŒ–çŸ¥è¯†ï¼ŒAI åŠ©æ•™è§£ç­”</p>-->
<!--        <p class="section-content">åˆ©ç”¨ AI æŠ€æœ¯æ„å»ºåœ°ç†çŸ¥è¯†å›¾è°±ï¼ŒChatGPT å³æ—¶ç­”ç–‘ã€‚</p>-->
<!--      </div>-->
<!--      &lt;!&ndash;    æ¢çŸ¥é—®å­¦ä»‹ç»  &ndash;&gt;-->
<!--      <div class="page4">-->
<!--        <h2 class="section-title">ğŸ“ æ™ºèƒ½æµ‹è¯„ï¼Œç²¾å‡†è¯Šæ–­</h2>-->
<!--        <div class="step-indicator">Step 3: æµ‹è¯•</div>-->
<!--        <p class="section-subtitle">æ‰¾åˆ°è–„å¼±ç‚¹ï¼Œé’ˆå¯¹æ€§æå‡</p>-->
<!--        <p class="section-content">ä¸ªæ€§åŒ–æ™ºèƒ½ä¹ é¢˜ï¼ŒAI è‡ªåŠ¨è§£æï¼ŒåŠ©ä½ çªç ´éš¾ç‚¹ã€‚</p>-->
<!--      </div>-->
<!--      &lt;!&ndash;    æ™ºèå­¦å ‚ä»‹ç»  &ndash;&gt;-->
<!--      <div class="page5">-->
<!--        <h2 class="section-title">ğŸ¯ ä¸ªæ€§åŒ–æ¨èï¼Œå®šåˆ¶å­¦ä¹ è·¯çº¿</h2>-->
<!--        <div class="step-indicator">Step 4: å·©å›º</div>-->
<!--        <p class="section-subtitle">æ™ºèƒ½æ¨èï¼Œå­¦ä¹ ä¸å†ç›²ç›®</p>-->
<!--        <p class="section-content">æ ¹æ®ä½ çš„å­¦ä¹ è½¨è¿¹ï¼ŒAI è‡ªåŠ¨æ¨é€æœ€é€‚åˆçš„èµ„æºã€‚</p>-->
<!--      </div>-->
<!--    </div>-->
<!--  </section>-->
</template>

<script setup>
import {onBeforeUnmount, onMounted, reactive} from "vue";
import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';
import MeteorClass from "@/classes/meteor.js";
import * as THREE from "three";
import {gsap} from "gsap";
import {ScrollTrigger} from "gsap/ScrollTrigger";

gsap.registerPlugin(ScrollTrigger)

let resize

const data = reactive({
  percentage:0,

})

onMounted(() => {
  /* particlesJS.load(@dom-id, @path-json, @callback (optional)); */
  particlesJS("video-particles", {
    particles: {
      number: { value: 60 },
      size: { value: 2 },
      move: { speed: 2 },
      opacity: { anim: { enable: true, speed: 0.5 } },
    },
  });
  // ScrollTrigger.create({
  //   trigger: '.section2',
  //   start: 'top+=50 top',
  //   end: '+=5000',
  //   scrub: true,
  //   pin:true,
  //   animation:
  //       gsap.timeline()
  //           .to('.transition-words',{opacity:0},0)
  //           .from('.progress',{opacity:0},0)
  //           .from('.page2',{opacity:0,duration:1},0)
  //           .to(data.percentage,{endArray:[100],duration:8,ease:'none'},1)
  //           .to('.page2',{x:() => '-=' + document.querySelector('.section2').offsetWidth},3)
  //           .from('.page3',{x:() => '+=' + document.querySelector('.section2').offsetWidth},3)
  //           .to('.page3',{x:() => '-=' + document.querySelector('.section2').offsetWidth},5)
  //           .from('.page4',{x:() => '+=' + document.querySelector('.section2').offsetWidth},5)
  //           .to('.page4',{x:() => '-=' + document.querySelector('.section2').offsetWidth},7)
  //           .from('.page5',{x:() => '+=' + document.querySelector('.section2').offsetWidth},7)
  // })
  // const scene = new THREE.Scene();
  // const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
  // camera.position.set(0, 0, 5);
  //
  // const renderer = new THREE.WebGLRenderer({ antialias: true });
  // renderer.setSize(window.innerWidth, window.innerHeight);
  // renderer.setClearColor(new THREE.Color(0x404040))
  // document.getElementById('earth-background').appendChild(renderer.domElement);
  //
  // const controls = new OrbitControls(camera, renderer.domElement);
  // controls.enableDamping = true;
  // controls.dampingFactor = 0.05;

// // åœ°çƒ
//   const textureLoader = new THREE.TextureLoader();
//   const earthTexture = textureLoader.load('/src/assets/2k_earth_daymap.jpg');
//   const earthGeometry = new THREE.SphereGeometry(1, 32, 32);
//   const earthMaterial = new THREE.MeshStandardMaterial({ map: earthTexture });
//   const earth = new THREE.Mesh(earthGeometry, earthMaterial);
//   scene.add(earth);
//
// // å…‰æº
//   const ambientLight = new THREE.AmbientLight(0x404040);
//   scene.add(ambientLight);
//
//   const pointLight = new THREE.PointLight(0xffffff, 50);
//   pointLight.position.set(5, 5, 5);
//   scene.add(pointLight);
//
// // æ˜Ÿç©º
//   const starsGeometry = new THREE.SphereGeometry(50, 64, 64);
//   const starsMaterial = new THREE.MeshBasicMaterial({
//     map: textureLoader.load('https://api.allorigins.win/get?url=' + encodeURIComponent('https://example.com/stars_texture.jpg')),
//     side: THREE.BackSide,
//   });
//   const stars = new THREE.Mesh(starsGeometry, starsMaterial);
//   scene.add(stars);
//
// // åŠ¨ç”»
//   function animate() {
//     requestAnimationFrame(animate);
//     earth.rotation.y += 0.005;
//     controls.update();
//     renderer.render(scene, camera);
//   }
//
//   animate();

  // // åˆ›å»ºæ˜Ÿç©ºéƒ¨åˆ†
  // (function (){
  //   const starScene = new THREE.Scene();
  //   const starCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
  //   const starRenderer = new THREE.WebGLRenderer({ alpha: true });
  //   starRenderer.setSize(
  //       document.getElementById('star-background').offsetWidth,
  //       document.getElementById('star-background').offsetHeight
  //   );
  //   starRenderer.setClearColor(0x0d0f1a)
  //   document.getElementById('star-background').appendChild(starRenderer.domElement);
  //   // åˆ›å»ºæ˜Ÿç©ºç²’å­
  //   const starsGeometry = new THREE.BufferGeometry();
  //   const starsVertices = [];
  //   for (let i = 0; i < 800; i++) {  // 800 é¢—æ˜Ÿæ˜Ÿ
  //     let x = (Math.random() - 0.5) * 2000;
  //     let y = (Math.random() - 0.5) * 2000;
  //     let z = (Math.random() - 0.5) * 2000;
  //     starsVertices.push(x, y, z);
  //   }
  //   starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
  //   const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 2 });
  //   const starField = new THREE.Points(starsGeometry, starsMaterial);
  //   starScene.add(starField);
  //
  //   const meteors = []; // ç”¨äºå­˜å‚¨æµæ˜Ÿå®ä¾‹
  //
  //   const meteorConfigs = [
  //     { color: { left: new THREE.Color("#0000ff"), right: new THREE.Color("#00ffff") }, duration: 1.2, hideDuration: 1, position: new THREE.Vector3(25,  25, -150), target: new THREE.Vector3(250,30, -150) }, // å·¦ä¾§
  //     { color: { left: new THREE.Color("#00aaff"), right: new THREE.Color("#ffffff") }, duration: 1.8, hideDuration: 0.6, position: new THREE.Vector3(50,  17, 0),  target: new THREE.Vector3(430,430, 0) }, // ä¸­é—´
  //     { color: { left: new THREE.Color("#ffffff"), right: new THREE.Color("#0000ff") }, duration: 1.9, hideDuration: 0.7, position: new THREE.Vector3(60,  -6, 0),  target: new THREE.Vector3(400, 400, 0) } // å³ä¾§
  //   ];
  //
  //   meteorConfigs.forEach(config => {
  //     const meteor = new MeteorClass(
  //         1000,
  //         config.target, // ç›®çš„åœ°
  //         config.color, // é¢œè‰²
  //         1,
  //         config.duration, // é£è¡Œæ—¶é•¿
  //         config.hideDuration, // æ¶ˆå¤±æ—¶é•¿
  //     );
  //     starScene.add(meteor.group);
  //     // å°†æµæ˜Ÿç»„çš„ä½ç½®è®¾ç½®ä¸ºé…ç½®ä¸­çš„ä½ç½®
  //     meteor.group.position.set(config.position.x, config.position.y, config.position.z);
  //     // æ—‹è½¬æµæ˜Ÿç»„
  //     meteor.group.rotateZ(Math.PI / 0.9);
  //     meteors.push(meteor);
  //   });
  //
  //   starCamera.position.z = 50;
  //   function starAnimate() {
  //     requestAnimationFrame(starAnimate);
  //     starField.rotation.y += 0.0002;  // ç¼“æ…¢æ—‹è½¬
  //     meteors.forEach(meteor => meteor.update()); // æ›´æ–°æ‰€æœ‰æµæ˜Ÿ
  //     starRenderer.render(starScene, starCamera);
  //   }
  //   starAnimate();
  //
  //   // æ·»åŠ  resize äº‹ä»¶ç›‘å¬å™¨ä»¥åŠæ—¶è°ƒæ•´çª—å£å¤§å°
  //   resize = () => {
  //     const width = document.getElementById('star-background').offsetWidth;
  //     const height = document.getElementById('star-background').offsetHeight;
  //
  //     starRenderer.setSize(width, height);
  //     starCamera.aspect = width / height;
  //     starCamera.updateProjectionMatrix();
  //   };
  //   window.addEventListener('resize', resize);
  //   resize(starRenderer,starCamera);
  //
  // })();
})

onBeforeUnmount( () => {
  // window.removeEventListener('resize',resize);
});
</script>

<style scoped>

.background {
  position: absolute;
  display: block;
  top: 0;
  left: 0;
  z-index: 0;
}


.page2 {
  position: absolute;
  width: 100%;
  height: 100vh;
  top: 100vh;
}


/* ç¬¬äºŒéƒ¨åˆ†ï¼Œæ ¹æ®éœ€è¦åŠ é•¿ */
.section2 {
  position: absolute;
  top: 100vh;
  height: 170vh;
}
/* è¿‡æ¸¡æ–‡å­— */
.transition-words {
  position: absolute;
  top: 12%;
  left: 35%;
  height: auto;
  font-size: 48px;
  font-weight: bold;
  color: rgba(0,0,0,0.5);
  text-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
}
/* è¿‡æ¸¡æ–‡å­—ä¸­éœ€è¦å¼ºè°ƒçš„æ–‡å­— */
.c1,.c2,.c5 {
  color: #f94604;
}
.container {
  position: relative;
  width: 100%;
  height: 100vh;
  background-color: var(--bg-color);
  overflow: hidden;
}
/* è¿›åº¦æ¡ */
.progress {
  position: absolute;
  top: 50%;
  left: 15%;
  width: 75%;
  height: auto;
  z-index: 5;
}

.step-indicator {
  display: inline-block;
  padding: 6px 16px;
  background: var(--secondary-color);
  color: white;
  font-size: 16px;
  font-weight: bold;
  border-radius: 20px;
}
.section-content {
  font-size: 18px;
  color: rgba(255, 255, 255, 0.8);
  max-width: 600px;
  line-height: 1.6;
  text-align: left;
  transform: translateY(20px);
}
.section-subtitle {
  font-size: 24px;
  font-weight: 400;
  color: #e0e0e0;
  transform: translateY(20px);
}
.section-title {
  font-size: 48px;
  font-weight: bold;
  color: white;
  text-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
}

.page2,.page3,.page4,.page5 {
  position: absolute;
  top: 45px;
  left: 0;
  height: 100vh;
  width: 100%;
  background-color: #333333;
  z-index: 0;
}
.page3 {
  background-color: #999999;
}
.page4 {
  background-color: red;
}
.page5 {
  background-color: blue;
}
.test-fixed {
  position: fixed;
  top: 50px;
  left: 50px;
  background: red;
  color: white;
  padding: 10px;
  z-index: 9999;
}
</style>
